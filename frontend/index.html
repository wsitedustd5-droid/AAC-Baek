<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ïò¨Ïù∏Ïõê AAC</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff7849">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
    <div id="app" class="app-container">
        
        <!-- ========== Ìó§Îçî ========== -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <i data-lucide="message-circle"></i>
                    <span>Ïò¨Ïù∏Ïõê<strong>AAC</strong></span>
                </div>
            </div>
            <div class="header-right">
                <button id="listenBtn" class="header-action-btn listen" title="ÏÉÅÎåÄÎ∞© Îßê Îì£Í∏∞">
                    <i data-lucide="mic"></i>
                </button>
            </div>
        </header>

        <!-- ========== Î©îÏù∏ Ïä¨ÎùºÏù¥Îìú ========== -->
        <main class="slide-container">
            <div class="slide-wrapper" id="slideWrapper">
                
                <!-- ===== ÌÉ≠ 1: ÎßêÌïòÍ∏∞ ===== -->
                <section class="slide" id="slideSpeak">
                    <!-- Í∏¥Í∏â Î≤ÑÌäº -->
                    <div class="emergency-bar">
                        <button class="emergency-btn" data-text="ÎèÑÏôÄÏ£ºÏÑ∏Ïöî!" data-icon="life-buoy">
                            <i data-lucide="life-buoy"></i>
                            <span>ÎèÑÏõÄ</span>
                        </button>
                        <button class="emergency-btn" data-text="ÏïÑÌååÏöî!" data-icon="heart-pulse">
                            <i data-lucide="heart-pulse"></i>
                            <span>ÏïÑÌîî</span>
                        </button>
                        <button class="emergency-btn" data-text="ÌôîÏû•Ïã§ Í∞ÄÍ≥† Ïã∂Ïñ¥Ïöî" data-icon="door-open">
                            <i data-lucide="door-open"></i>
                            <span>ÌôîÏû•Ïã§</span>
                        </button>
                    </div>

                    <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ ÌÉ≠ -->
                    <div class="category-tabs">
                        <button class="tab-btn active" data-category="action">
                            <i data-lucide="footprints"></i>
                            <span>ÌñâÎèô</span>
                        </button>
                        <button class="tab-btn" data-category="feeling">
                            <i data-lucide="smile"></i>
                            <span>Í∞êÏ†ï</span>
                        </button>
                        <button class="tab-btn" data-category="need">
                            <i data-lucide="hand"></i>
                            <span>ÏöîÏ≤≠</span>
                        </button>
                        <button class="tab-btn" data-category="pain">
                            <i data-lucide="activity"></i>
                            <span>ÌÜµÏ¶ù</span>
                        </button>
                        <button class="tab-btn" data-category="place">
                            <i data-lucide="map-pin"></i>
                            <span>Ïû•ÏÜå</span>
                        </button>
                        <button class="tab-btn" data-category="person">
                            <i data-lucide="users"></i>
                            <span>ÏÇ¨Îûå</span>
                        </button>
                        <button class="tab-btn" data-category="food">
                            <i data-lucide="utensils"></i>
                            <span>ÏùåÏãù</span>
                        </button>
                        <button class="tab-btn" data-category="time">
                            <i data-lucide="clock"></i>
                            <span>ÏãúÍ∞Ñ</span>
                        </button>
                    </div>

                    <!-- Ïπ¥Îìú Í∑∏Î¶¨Îìú -->
                    <div class="cards-area">
                        <div id="cardsContainer" class="cards-container"></div>
                    </div>

                    <!-- ÌÜµÏ¶ù Ïä§ÏºÄÏùº -->
                    <div id="painScale" class="pain-scale hidden">
                        <div class="pain-title">ÌÜµÏ¶ù Ï†ïÎèÑ</div>
                        <div class="pain-buttons" id="painButtons"></div>
                        <div class="pain-labels">
                            <span>ÏïΩÌï®</span>
                            <span>Î≥¥ÌÜµ</span>
                            <span>Ïã¨Ìï®</span>
                        </div>
                    </div>

                    <!-- AI Ï∂îÏ≤ú Ìå®ÎÑê -->
                    <div id="aiSuggestPanel" class="ai-suggest-panel hidden">
                        <div class="ai-suggest-header">
                            <i data-lucide="sparkles"></i>
                            <span id="aiSuggestWord">Îã®Ïñ¥</span> Îã§ÏùåÏóê...
                            <button id="closeSuggestPanel" class="close-btn">
                                <i data-lucide="x"></i>
                            </button>
                        </div>
                        <div id="aiSuggestions" class="ai-suggestions"></div>
                    </div>
                </section>

                <!-- ===== ÌÉ≠ 2: ÏÇ¨Ïö© Í∏∞Î°ù ===== -->
                <section class="slide" id="slideHistory">
                    <div class="slide-header">
                        <h2>ÏÇ¨Ïö© Í∏∞Î°ù</h2>
                        <button id="clearHistoryBtn" class="text-btn danger">
                            <i data-lucide="trash-2"></i>
                            Ï†ÑÏ≤¥ ÏÇ≠Ï†ú
                        </button>
                    </div>
                    <div id="historyContainer" class="history-container">
                        <p class="empty-message">ÏïÑÏßÅ ÏÇ¨Ïö© Í∏∞Î°ùÏù¥ ÏóÜÏäµÎãàÎã§</p>
                    </div>
                </section>

                <!-- ===== ÌÉ≠ 3: Í≤ÄÏÉâ ===== -->
                <section class="slide" id="slideSearch">
                    <div class="search-box">
                        <i data-lucide="search"></i>
                        <input type="text" id="searchInput" placeholder="Îã®Ïñ¥ÎÇò Î¨∏Ïû• Í≤ÄÏÉâ...">
                    </div>
                    <div id="searchResults" class="search-results"></div>
                </section>

                <!-- ===== ÌÉ≠ 4: ÏÑ§Ï†ï (ÏàòÏ†ïÎê®) ===== -->
                <section class="slide" id="slideSettings">
                    <div class="settings-content">
                        <!-- 1. ÌôîÎ©¥ ÏÑ§Ï†ï -->
                        <div class="settings-section">
                            <div class="settings-section-title">
                                <i data-lucide="monitor"></i>
                                <span>ÌôîÎ©¥</span>
                            </div>
                            <!-- Í∏ÄÏûê ÌÅ¨Í∏∞ -->
                            <div class="setting-item">
                                <label>Í∏ÄÏûê ÌÅ¨Í∏∞</label>
                                <select id="fontSize">
                                    <option value="small">ÏûëÍ≤å</option>
                                    <option value="medium" selected>Î≥¥ÌÜµ</option>
                                    <option value="large">ÌÅ¨Í≤å</option>
                                </select>
                            </div>
                            <!-- Îã§ÌÅ¨ Î™®Îìú (Í∏∞Ï°¥) -->
                            <div class="setting-item toggle">
                                <label>
                                    <i data-lucide="moon"></i>
                                    Îã§ÌÅ¨ Î™®Îìú
                                </label>
                                <label class="switch">
                                    <input type="checkbox" id="darkModeToggle">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <!-- 2. ÏùåÏÑ± Î∞è ÌîºÎìúÎ∞± (Ïã†ÏÑ§) -->
                        <div class="settings-section">
                            <div class="settings-section-title">
                                <i data-lucide="volume-2"></i>
                                <span>ÏùåÏÑ± Î∞è ÌîºÎìúÎ∞±</span>
                            </div>
                            <!-- (Ï∂îÍ∞Ä) ÎßêÌïòÍ∏∞ ÏÜçÎèÑ -->
                            <div class="setting-item">
                                <label>ÎßêÌïòÍ∏∞ ÏÜçÎèÑ</label>
                                <div class="range-wrapper">
                                    <span>ÎäêÎ¶º</span>
                                    <input type="range" id="ttsSpeedRange" min="0.5" max="1.5" step="0.1" value="0.9">
                                    <span>Îπ†Î¶Ñ</span>
                                </div>
                            </div>
                            <!-- (Ï∂îÍ∞Ä) ÏßÑÎèô ÌîºÎìúÎ∞± -->
                            <div class="setting-item toggle">
                                <label>
                                    <i data-lucide="vibrate"></i>
                                    ÏßÑÎèô ÌîºÎìúÎ∞±
                                </label>
                                <label class="switch">
                                    <input type="checkbox" id="hapticToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <!-- 3. AI Í∏∞Îä• (Í∏∞Ï°¥ Ïú†ÏßÄ) -->
                        <div class="settings-section">
                            <div class="settings-section-title">
                                <i data-lucide="sparkles"></i>
                                <span>AI Í∏∞Îä•</span>
                            </div>
                            <div class="setting-item ai-feature">
                                <div class="ai-feature-info">
                                    <i data-lucide="mic"></i>
                                    <div>
                                        <strong>Ïä§ÎßàÌä∏ ÏùåÏÑ± (Ï§ÄÎπÑ Ï§ë)</strong>
                                        <p>Ï£ºÎ≥Ä ÏÜåÏùåÏóê Îî∞Îùº Î≥ºÎ•® ÏûêÎèô Ï°∞Ï†à</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 4. ÎèÑÏõÄÎßê (Í∏∞Ï°¥ Ïú†ÏßÄ) -->
                        <div class="settings-section">
                            <div class="settings-section-title">
                                <i data-lucide="help-circle"></i>
                                <span>ÏÇ¨Ïö©Î≤ï</span>
                            </div>
                            <div class="help-list">
                                <div class="help-item">
                                    <i data-lucide="hand"></i>
                                    <div>
                                        <strong>Ïπ¥Îìú ÏÑ†ÌÉù</strong>
                                        <p>Ïπ¥ÎìúÎ•º ÌÑ∞ÏπòÌïòÎ©¥ Î©îÏãúÏßÄÍ∞Ä ÏÑ†ÌÉùÎê©ÎãàÎã§</p>
                                    </div>
                                </div>
                                <!-- ... ÎÇòÎ®∏ÏßÄ ÎèÑÏõÄÎßê Ìï≠Î™©Îì§ (Í∏∞Ï°¥Í≥º ÎèôÏùº) ... -->
                            </div>
                        </div>

                        <!-- Ïï± Ï†ïÎ≥¥ -->
                        <div class="app-info">
                            <div class="app-info-logo">
                                <i data-lucide="heart"></i>
                                <span>Î∞îÏù¥Ïò§Ìó¨Ïä§ ÏõêÌåÄ</span>
                            </div>
                            <p>Î≤ÑÏ†Ñ 2.1.0 (Í∞úÏÑ†Ìåê)</p>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- ========== Ï∂úÎ†• Î∞î ========== -->
        <div class="output-bar">
            <div id="outputText" class="output-text">
                <span class="placeholder">Ïπ¥ÎìúÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</span>
            </div>
            <div class="output-actions">
                <button id="speakBtn" class="output-btn speak" disabled>
                    <i data-lucide="volume-2"></i>
                </button>
                <button id="showBtn" class="output-btn show" disabled>
                    <i data-lucide="maximize-2"></i>
                </button>
                <button id="clearBtn" class="output-btn clear" disabled>
                    <i data-lucide="x"></i>
                </button>
            </div>
        </div>

        <!-- ========== ÌïòÎã® ÌÉ≠ Î∞î ========== -->
        <nav class="tab-bar">
            <button class="tab-bar-btn active" data-slide="0">
                <i data-lucide="message-square"></i>
                <span>ÎßêÌïòÍ∏∞</span>
            </button>
            <button class="tab-bar-btn" data-slide="1">
                <i data-lucide="history"></i>
                <span>Í∏∞Î°ù</span>
            </button>
            <button class="tab-bar-btn" data-slide="2">
                <i data-lucide="search"></i>
                <span>Í≤ÄÏÉâ</span>
            </button>
            <button class="tab-bar-btn" data-slide="3">
                <i data-lucide="settings"></i>
                <span>ÏÑ§Ï†ï</span>
            </button>
        </nav>
    </div>

    <!-- ========== Ï≤≠Ïûê Î™®Îìú Î™®Îã¨ ========== -->
    <div id="listenerModal" class="modal-fullscreen hidden">
        <button id="closeListenerModal" class="modal-close">
            <i data-lucide="x"></i>
        </button>
        <div class="listener-content">
            <div id="listenerIcon" class="listener-icon">
                <i data-lucide="message-circle"></i>
            </div>
            <div id="listenerText" class="listener-text">Î©îÏãúÏßÄ</div>
        </div>
    </div>

    <!-- ========== ÏùåÏÑ± Ïù∏Ïãù Í≤∞Í≥º Î™®Îã¨ ========== -->
    <div id="listenResultModal" class="modal-overlay hidden">
        <div class="modal-content listen-modal">
            <div class="modal-header">
                <h3>
                    <i data-lucide="mic"></i>
                    ÏÉÅÎåÄÎ∞©Ïù¥ ÎßêÌïú ÎÇ¥Ïö©
                </h3>
                <button id="closeListenModal" class="modal-close-btn">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="heard-text-box">
                    <i data-lucide="quote"></i>
                    <span id="heardText">Ïù∏ÏãùÎêú ÎÇ¥Ïö©</span>
                </div>
                <div class="response-title">
                    <i data-lucide="message-circle"></i>
                    <span>Ïù¥Î†áÍ≤å ÎãµÌï¥Î≥¥ÏÑ∏Ïöî</span>
                </div>
                <div id="aiResponses" class="ai-responses"></div>
            </div>
        </div>
    </div>

    <!-- ========== Ïπ¥Îìú Ï∂îÍ∞Ä Î™®Îã¨ ========== -->
    <div id="addCardModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ÏÉà Ïπ¥Îìú Ï∂îÍ∞Ä</h3>
                <button id="closeAddCardModal" class="modal-close-btn">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="image-upload-section">
                    <label>üì∏ ÏÇ¨ÏßÑÏúºÎ°ú ÎßåÎì§Í∏∞ (AI - Ï§ÄÎπÑÏ§ë)</label>
                    <input type="file" id="cardImageInput" accept="image/*" capture="environment" hidden>
                    <button type="button" id="uploadImageBtn" class="upload-btn">
                        <i data-lucide="camera"></i>
                        <span>ÏÇ¨ÏßÑ Ï¥¨ÏòÅ/ÏÑ†ÌÉù</span>
                    </button>
                    <div id="imagePreview" class="image-preview hidden">
                        <img id="previewImg" src="" alt="">
                        <button id="removeImageBtn" class="remove-img-btn">
                            <i data-lucide="x"></i>
                        </button>
                    </div>
                </div>

                <div class="divider"><span>ÎòêÎäî</span></div>

                <div class="form-group">
                    <label>Ïπ¥Îìú ÌÖçÏä§Ìä∏</label>
                    <input type="text" id="newCardText" placeholder="Ïòà: ÏÇ¨ÎûëÌï¥Ïöî" maxlength="20">
                </div>
                <div class="form-group">
                    <label>ÏïÑÏù¥ÏΩò</label>
                    <div id="iconSelector" class="icon-grid"></div>
                </div>
                <div class="card-preview-section">
                    <label>ÎØ∏Î¶¨Î≥¥Í∏∞</label>
                    <div id="cardPreview" class="card-preview">
                        <div class="card-icon"><i data-lucide="message-circle"></i></div>
                        <div class="card-text">ÏÉà Ïπ¥Îìú</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelAddCard" class="secondary-btn">Ï∑®ÏÜå</button>
                <button id="confirmAddCard" class="primary-btn">
                    <i data-lucide="plus"></i>
                    Ï∂îÍ∞Ä
                </button>
            </div>
        </div>
    </div>

    <!-- ========== Î°±ÌîÑÎ†àÏä§ Î©îÎâ¥ ========== -->
    <div id="longpressMenu" class="longpress-menu hidden"></div>
    <div id="longpressOverlay" class="longpress-overlay hidden"></div>

    <!-- Lucide ÏïÑÏù¥ÏΩò Î®ºÏ†Ä Î°úÎìú -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- ÌïòÎÇòÎ°ú Ìï©Ïπú JS -->
    <script src="js/app.js"></script>

    <!-- Í∏∞Ï°¥ ÏÑúÎπÑÏä§ ÏõåÏª§ Ìï¥Ï†ú -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(regs => {
                regs.forEach(reg => reg.unregister());
            });
        }
    </script>
</body>
</html>